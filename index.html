

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to the decayamplitude software Project &mdash; decayamplitude 09.02.2025 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=b839af5d"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            decayamplitude
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to the decayamplitude software Project</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#goal">Goal</a></li>
<li><a class="reference internal" href="#online-decay-editor">Online Decay Editor</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#related-projects">Related projects</a></li>
<li><a class="reference internal" href="#how-to-cite">How to cite</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">decayamplitude</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Welcome to the decayamplitude software Project</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound" id="module-decayamplitude">
</div>
<section id="welcome-to-the-decayamplitude-software-project">
<h1>Welcome to the decayamplitude software Project<a class="headerlink" href="#welcome-to-the-decayamplitude-software-project" title="Link to this heading"></a></h1>
<a class="reference external image-reference" href="https://pypi.org/project/decayamplitude/"><img alt="PyPI - Version" src="https://img.shields.io/pypi/v/decayamplitude.svg" />
</a>
<a class="reference external image-reference" href="https://pypi.org/project/decayamplitude/"><img alt="PyPI - Python Version" src="https://img.shields.io/pypi/pyversions/decayamplitude.svg" />
</a>
<a class="reference external image-reference" href="https://codecov.io/gh/KaiHabermann/decayamplitude"><img alt="codecov" src="https://codecov.io/gh/KaiHabermann/decayamplitude/graph/badge.svg?token=KXBO8KEQ3V" />
</a>
<hr class="docutils" />
<p><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><span class="xref std std-ref">Installation</span></p></li>
<li><p><span class="xref std std-ref">Goal</span></p></li>
<li><p><span class="xref std std-ref">Related projects</span></p></li>
<li><p><span class="xref std std-ref">How to cite</span></p></li>
<li><p><span class="xref std std-ref">License</span></p></li>
</ul>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install decayamplitude</span>
</pre></div>
</div>
</section>
<section id="goal">
<h2>Goal<a class="headerlink" href="#goal" title="Link to this heading"></a></h2>
<p>The software project <code class="docutils literal notranslate"><span class="pre">decayamplitude</span></code> provides an amplitude package working in tandem with <code class="docutils literal notranslate"><span class="pre">decayangle</span></code> to build full cascade reaction amplitudes.
The main goal is to provide a simple interface to build decay chains and their amplitudes, which can be used in amplitude analyses.</p>
</section>
<section id="online-decay-editor">
<h2>Online Decay Editor<a class="headerlink" href="#online-decay-editor" title="Link to this heading"></a></h2>
<p>There is a beta version of a web based decay editor, which is hosted <a class="reference external" href="https://kaihabermann.github.io/DecaySelector/">here</a>.
The Website allows for an easy selection of a decay and resonances. Once finished a script generating an amplitude with <code class="docutils literal notranslate"><span class="pre">decayamplitude</span></code> can be downloaded.
This is usually the easiest and quickest way to get a working amplitude. Explicit lineshapes need then to be defined by the user, where it is marked in the downloaded script.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">decayamplitude.resonance</span><span class="w"> </span><span class="kn">import</span> <span class="n">Resonance</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">decayamplitude.rotation</span><span class="w"> </span><span class="kn">import</span> <span class="n">QN</span><span class="p">,</span> <span class="n">Angular</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">decayamplitude.chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecayChain</span><span class="p">,</span> <span class="n">MultiChain</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">decayamplitude.combiner</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChainCombiner</span>




<span class="kn">from</span><span class="w"> </span><span class="nn">decayangle.decay_topology</span><span class="w"> </span><span class="kn">import</span> <span class="n">Topology</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="n">TopologyCollection</span>

<span class="c1"># First we define the final state</span>
<span class="n">final_state_qn</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="n">QN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="mi">2</span><span class="p">:</span> <span class="n">QN</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="mi">3</span><span class="p">:</span> <span class="n">QN</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># decayangles Topology class is used to generate the angular variables. Be carefull here, as fit results may depend on the ordering.</span>

<span class="n">topology1</span> <span class="o">=</span> <span class="n">Topology</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">decay_topology</span><span class="o">=</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">topology2</span> <span class="o">=</span> <span class="n">Topology</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">decay_topology</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># alternatively we can use the topology collection to define all topologies automatically</span>
<span class="n">tg</span> <span class="o">=</span> <span class="n">TopologyCollection</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">tg</span><span class="o">.</span><span class="n">topologies</span>
</pre></div>
</div>
<p>We now have a basic definition of our decay scheme. But we need resonances to react. In general for a multi body decay we want to define a list of resonances for each isobar. Then let the code figure out all the possible decay chains.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">resonances1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># we need to define resonances for each internal node of the decay chain</span>
    <span class="c1"># A resonance needs a node, to which it couples, quantum numbers, a lineshape</span>
    <span class="c1"># and a list of argument names, which will be used to map the parameters of the resonance</span>
    <span class="c1"># to the outside, once all our configurations are combined into an amplitude</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span> <span class="n">Resonance</span><span class="p">(</span><span class="n">topology1</span><span class="o">.</span><span class="n">nodes</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
                    <span class="n">quantum_numbers</span><span class="o">=</span><span class="n">QN</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">lineshape</span><span class="o">=</span><span class="n">BW_lineshape</span><span class="p">(</span><span class="n">topology1</span><span class="o">.</span><span class="n">nodes</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span><span class="n">momenta</span><span class="p">)),</span>
                    <span class="n">argnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gamma1&quot;</span><span class="p">,</span> <span class="s2">&quot;m01&quot;</span><span class="p">]),</span>

    <span class="c1"># since we can not only model decays, but also transitions from 2 particle</span>
        <span class="c1"># to many particles</span>
    <span class="c1"># Thus we may have to model multiple initial resonances and their production</span>
        <span class="c1"># with a lineshape</span>
    <span class="c1"># For decays we can use a constant lineshape</span>
    <span class="c1"># The preserve_parity flag controlls which L S couplings will be produced,</span>
        <span class="c1"># if one uses the automated generation of the possible couplings</span>
    <span class="c1"># This has no effect if one plugs in couplings by hand</span>
    <span class="mi">0</span><span class="p">:</span> <span class="n">Resonance</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">quantum_numbers</span><span class="o">=</span><span class="n">QN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">lineshape</span><span class="o">=</span><span class="n">constant_lineshape</span><span class="p">,</span>
    <span class="n">argnames</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">preserve_partity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># we use the argnames, to use the same mass for both BW lineshapes, but different widths</span>
<span class="n">resonances2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">Resonance</span><span class="p">(</span><span class="n">nodes_2</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">quantum_numbers</span><span class="o">=</span><span class="n">QN</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">lineshape</span><span class="o">=</span><span class="n">BW_lineshape</span><span class="p">(</span><span class="n">nodes_2</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span><span class="n">momenta</span><span class="p">)),</span> <span class="n">argnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gamma2&quot;</span><span class="p">,</span> <span class="s2">&quot;m01&quot;</span><span class="p">]),</span>
    <span class="mi">0</span><span class="p">:</span> <span class="n">Resonance</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">quantum_numbers</span><span class="o">=</span><span class="n">QN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">lineshape</span><span class="o">=</span><span class="n">constant_lineshape</span><span class="p">,</span> <span class="n">argnames</span><span class="o">=</span><span class="p">[],</span> <span class="n">preserve_partity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now we can take the resonance dictionaries and combine them with a topology in order to produce a <code class="docutils literal notranslate"><span class="pre">DecayChain</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chain1</span> <span class="o">=</span> <span class="n">DecayChain</span><span class="p">(</span><span class="n">topology</span> <span class="o">=</span> <span class="n">topology1</span><span class="p">,</span>
        <span class="n">resonances</span> <span class="o">=</span> <span class="n">resonances1</span><span class="p">,</span>
        <span class="n">momenta</span> <span class="o">=</span> <span class="n">momenta</span><span class="p">,</span>
        <span class="n">final_state_qn</span> <span class="o">=</span> <span class="n">final_state_qn</span><span class="p">)</span>

<span class="n">chain2</span> <span class="o">=</span> <span class="n">DecayChain</span><span class="p">(</span><span class="n">topology</span> <span class="o">=</span> <span class="n">topology2</span><span class="p">,</span>
        <span class="n">resonances</span> <span class="o">=</span> <span class="n">resonances2</span><span class="p">,</span>
        <span class="n">momenta</span> <span class="o">=</span> <span class="n">momenta</span><span class="p">,</span>
        <span class="n">final_state_qn</span> <span class="o">=</span> <span class="n">final_state_qn</span><span class="p">)</span>
</pre></div>
</div>
<p>These chains are already able to produce a chain function, which can be evaluated for a given set of parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chain1</span><span class="o">.</span><span class="n">chain_function</span>
</pre></div>
</div>
<p>We can now combine the chains into a <code class="docutils literal notranslate"><span class="pre">ChainCombiner</span></code> object. This object will internally take care of the alignmeht operations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">combined</span> <span class="o">=</span> <span class="n">ChainCombiner</span><span class="p">([</span><span class="n">chain1</span><span class="p">,</span> <span class="n">chain2</span><span class="p">])</span>

<span class="c1"># we can generate the unpolarized amplitude</span>
<span class="n">unpolarized</span><span class="p">,</span> <span class="n">argnames</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">unpolarized_amplitude</span><span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">generate_couplings</span><span class="p">())</span>
<span class="c1"># unpolarized(*args) will return the amplitude for the given parameters</span>

<span class="c1"># we can generate the matix elements depending on the polarization of the particles</span>
<span class="n">polarized</span><span class="p">,</span> <span class="n">lambdas</span><span class="p">,</span> <span class="n">argnames</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">polarized_amplitude</span><span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">generate_couplings</span><span class="p">())</span>
<span class="c1"># polarized(*lambdas, *args) will return the amplitude for the given parameters and polarization</span>

<span class="c1"># here we get a list of aditional function parameters, which represent the polarization of the initial and final state particles</span>
<span class="c1"># lambdas = [&quot;h_0&quot;, &quot;h_1&quot;, &quot;h_2&quot;, &quot;h_3&quot;]</span>

<span class="c1"># alternatively we can produce all matrix elements at once</span>
<span class="n">matrx_function</span><span class="p">,</span> <span class="n">matrix_argnames</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">matrix_function</span><span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">generate_couplings</span><span class="p">())</span>
<span class="c1"># here we only have the initial state polarization as an additional parameter</span>
<span class="c1"># matrix_argnames = [&quot;h_0&quot;] + argnames</span>
<span class="c1"># matrx_function(h_0, *args) will return the amplitude for the given parameters and polarization</span>
</pre></div>
</div>
</section>
<section id="related-projects">
<h2>Related projects<a class="headerlink" href="#related-projects" title="Link to this heading"></a></h2>
<p>Amplitude analyses dealing with non-zero spin of final-state particles have to implement wigner rotations in some way.
However, there are a few projects addressing these rotations explicitly using analytic expressions in <a class="reference external" href="https://inspirehep.net/literature/1758460">DPD paper</a>, derived for three-body decays:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/mmikhasenko/ThreeBodyDecays.jl">ThreeBodyDecays.jl</a>,</p></li>
<li><p><a class="reference external" href="https://github.com/mmikhasenko/SymbolicThreeBodyDecays.jl">SymbolicThreeBodyDecays.jl</a>,</p></li>
<li><p><a class="reference external" href="https://github.com/ComPWA/ampform-dpd">ComPWA/ampform-dpd</a>.</p></li>
</ul>
</section>
<section id="how-to-cite">
<h2>How to cite<a class="headerlink" href="#how-to-cite" title="Link to this heading"></a></h2>
<p>This software package as well as the closely related <a class="reference external" href="https://github.com/KaiHabermann/decayangle">decayangle</a> should be cited by the accompaning paper
<a class="reference external" href="https://doi.org/10.1103/PhysRevD.111.056015">Wigner Rotations for Cascade Reactions</a></p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">decayamplitude</span></code> is distributed under the terms of the <a class="reference external" href="https://mit-license.org/">MIT</a> license.</p>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kai Habermann.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>